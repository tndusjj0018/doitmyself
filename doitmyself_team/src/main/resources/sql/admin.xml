<?xml version="1.0" encoding="UTF-8"?>	<!-- SQL 맵퍼 파일은 xml 이기 때문에 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Admin">
	<select id="memberListCount" resultType="int" parameterType="map">
		select count(*) from user_tbl
		<if test="search_col!= null and search_word !=null">
			<where>
				<choose>
					<when test="search_col == 'USER_ID'">USER_ID</when>
					<when test="search_col == 'USER_NAME'">USER_NAME</when>
					<when test="search_col == 'USER_BIRTH'">USER_BIRTH</when>
					<when test="search_col == 'USER_PHONE'">USER_PHONE</when>
					<when test="search_col == 'USER_EMAIL'">USER_EMAIL</when>
				</choose>
				like '%'||#{search_word}||'%'
			</where>
		</if>
	</select>
	
	<select id="memberList" resultType="member" parameterType="map">
		select * from user_tbl
		<if test="search_col!= null and search_word !=null">
			<where>
				<if test="option == 0 or option == 1">
					USER_IS_ADMIN = #{option} 
				</if>
				<if test="option != null and search_word != null">
					and 
				</if>
				<choose>
					<when test="search_col == 'USER_ID'">USER_ID</when>
					<when test="search_col == 'USER_NAME'">USER_NAME</when>
					<when test="search_col == 'USER_BIRTH'">USER_BIRTH</when>
					<when test="search_col == 'USER_PHONE'">USER_PHONE</when>
					<when test="search_col == 'USER_EMAIL'">USER_EMAIL</when>
				</choose>
				like '%'||#{search_word}||'%'
				
			</where>
		</if>
	</select>
	
	<select id="reviewCount" resultType="int">
		select count(*) from review_tbl
	</select>
	
	<select id="reviewList" resultType="review" parameterType="map">
		select * from review_tbl
		<where>
			
		</where>
		order by #{orderBy} 
	</select>
	
	<delete id="deleteUser" parameterType="int">
		delete from user_tbl where user_no = #{USER_NO}
	</delete>
	
	<select id="userinfo" parameterType="int" resultType="member">
		select * from user_tbl where user_no = #{USER_NO}
	</select>
	
	<update id="modifyUser" parameterType="member">
		update user_tbl 
		set  USER_NAME = #{USER_NAME},
			 USER_PASSWORD = #{USER_PASSWORD},
			 USER_ADDRESS = #{USER_ADDRESS},
			 USER_POSTCODE = #{USER_POSTCODE},
			 USER_PHONE = #{USER_PHONE},
			 USER_EMAIL = #{USER_EMAIL}
		where USER_NO = #{USER_NO}
	</update>
	
	<select id="passCheck" parameterType="int">
		select USER_PASSWORD FROM USER_TBL 
		WHERE USER_NO = #{USER_NO} 
	</select>
	
	<update id="updatePrivilege" parameterType="map">
		update user_tbl
		set USER_IS_ADMIN = #{USER_IS_ADMIN}
		where USER_NO = #{USER_NO}
	</update>
	

	
</mapper>